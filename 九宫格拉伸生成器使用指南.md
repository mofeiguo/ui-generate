# 九宫格拉伸生成器使用指南

## 🎯 什么是九宫格拉伸？

九宫格拉伸（Nine-Slice Scaling）是游戏开发和UI设计中的经典技术，通过4条分割线将图片分成9个区域，实现智能的图片拉伸：

- 🔲 **四个角** - 保持原样不变形
- ↔️ **上下边** - 只水平拉伸 
- ↕️ **左右边** - 只垂直拉伸
- 🔄 **中心区** - 双向拉伸

这样可以让UI元素（如按钮、对话框背景）适应任意尺寸而保持美观。

---

## 🌟 核心原理

### 📐 分区规则
```
┌─────┬─────────┬─────┐
│ 角  │  ←→    │ 角  │  <- 上行：角保持，中间横拉
├─────┼─────────┼─────┤
│ ↑↓  │ ↔↕     │ ↑↓  │  <- 中行：左右竖拉，中心双拉
├─────┼─────────┼─────┤
│ 角  │  ←→    │ 角  │  <- 下行：角保持，中间横拉
└─────┴─────────┴─────┘
```

### 🎨 拉伸行为
1. **四个角落**：保持原始像素，不拉伸不变形
2. **上下边缘**：水平方向重复拉伸，垂直保持
3. **左右边缘**：垂直方向重复拉伸，水平保持  
4. **中心区域**：水平和垂直双向拉伸

---

## 🚀 快速开始

### 第一步：打开九宫格拉伸生成器
1. 启动UI素材生成器
2. 在左侧工具栏找到**"图片工具"**区域
3. 点击紫色的**"九宫格拉伸生成器"**按钮

### 第二步：上传图片
- **方式1**：拖拽图片文件到上传区域
- **方式2**：点击**"选择图片"**按钮
- **推荐**：选择有边框、圆角或装饰元素的UI图片

### 第三步：调整分割线
1. 图片加载后会显示**红色分割线**（2条垂直线 + 2条水平线）
2. 拖拽**红色方块手柄**调整分割线位置
3. 实时预览9个区域的划分效果

### 第四步：设置目标尺寸
- 在右侧输入框设置**目标宽度**和**目标高度**
- 可以设置任意尺寸（建议在50-2000px范围内）

### 第五步：生成和下载
1. 点击**"生成预览"**按钮查看拉伸效果
2. 确认满意后点击**"下载"**按钮保存图片

---

## 🛠 详细操作指南

### 📱 界面布局
- **左侧**：原图编辑区域，可拖拽调整分割线
- **右侧**：设置面板和预览区域
- **分割线**：红色虚线，带红色方块手柄
- **区域标识**：显示各区域的拉伸类型

### 🖱 交互操作
#### **调整分割线**
- **垂直线1**：拖拽左侧垂直线的红色手柄
- **垂直线2**：拖拽右侧垂直线的红色手柄
- **水平线1**：拖拽上方水平线的红色手柄
- **水平线2**：拖拽下方水平线的红色手柄

#### **手柄位置**
- 垂直线手柄位于图片**中间高度**
- 水平线手柄位于图片**中间宽度**
- 拖拽时有**最小距离限制**（10像素）

#### **实时反馈**
- 拖拽时分割线实时更新
- 各区域显示拉伸类型标识
- 边界限制防止重叠

---

## 🎨 实际应用案例

### 📱 游戏按钮背景
```
原始图片: 按钮.png (100x40px)
┌───────┬──────────┬───────┐
│ 圆角   │  顶部边框  │ 圆角   │ 
├───────┼──────────┼───────┤
│ 左边框 │   背景    │右边框  │
├───────┼──────────┼───────┤
│ 圆角   │  底部边框  │ 圆角   │
└───────┴──────────┴───────┘

拉伸设置:
- 分割线位置: 左30px, 右70px, 上12px, 下28px
- 目标尺寸: 200x40px (宽度翻倍)

结果: 圆角保持，中间背景和边框水平拉伸
```

### 🎯 对话框背景
```
原始图片: 对话框.png (150x100px)
┌──────┬─────────────┬──────┐
│ 左上角│    标题栏    │右上角 │
├──────┼─────────────┼──────┤
│ 左边框│   内容区域   │右边框 │
├──────┼─────────────┼──────┤
│ 左下角│    底部     │右下角 │
└──────┴─────────────┴──────┘

拉伸设置:
- 分割线位置: 左25px, 右125px, 上30px, 下70px  
- 目标尺寸: 300x200px

结果: 内容区域扩大，边框和角落保持美观
```

### 🏷️ 进度条背景
```
原始图片: 进度条.png (120x20px)
┌─────┬──────────────┬─────┐
│左端 │     轨道      │右端 │
└─────┴──────────────┴─────┘

拉伸设置:
- 分割线位置: 左10px, 右110px, 上0px, 下20px
- 目标尺寸: 300x20px

结果: 轨道水平拉伸，两端保持圆角
```

---

## 🎯 最佳实践

### ✅ 适合的图片类型
1. **UI按钮背景**
   - 有圆角、边框、渐变的按钮
   - 中间有纯色或简单图案的区域

2. **对话框/面板背景**  
   - 有装饰边框的面板
   - 标题栏和内容区分明的界面

3. **进度条/滑块轨道**
   - 两端有特殊形状的轨道
   - 中间可重复的纹理

4. **装饰边框**
   - 有角落装饰的边框
   - 可重复的中间部分

### ❌ 不适合的图片类型
1. **复杂图案**：包含不可重复的复杂图案
2. **照片内容**：真实照片或风景图
3. **文字内容**：包含大量文字的图片
4. **不规则形状**：形状不规则，难以分区

### 🎨 分割线设置技巧
1. **保护关键元素**
   - 将圆角、装饰放在角落区域
   - 将重要图案放在不拉伸的区域

2. **选择合适的拉伸区域**
   - 选择纯色或简单纹理区域作为拉伸区
   - 避免在渐变边界设置分割线

3. **平衡比例**
   - 角落区域不要太大，影响拉伸效果
   - 拉伸区域不要太小，拉伸质量下降

4. **测试验证**
   - 尝试多种目标尺寸验证效果
   - 检查极端尺寸下的表现

---

## 🔧 技术细节

### 📐 算法原理
九宫格拉伸使用**区域映射**算法：

```typescript
// 将源图9个区域映射到目标图9个区域
const srcRegions = calculateSourceRegions(image, lines);
const destRegions = calculateTargetRegions(targetSize, lines);

// 逐区域绘制
srcRegions.forEach((src, index) => {
  const dest = destRegions[index];
  ctx.drawImage(image, 
    src.x, src.y, src.width, src.height,    // 源区域
    dest.x, dest.y, dest.width, dest.height // 目标区域
  );
});
```

### 🎯 尺寸计算
```typescript
// 固定区域尺寸（角落和边缘装饰）
const leftWidth = lines.vertical1;
const rightWidth = image.width - lines.vertical2;
const topHeight = lines.horizontal1; 
const bottomHeight = image.height - lines.horizontal2;

// 可拉伸区域尺寸
const centerWidth = targetWidth - leftWidth - rightWidth;
const middleHeight = targetHeight - topHeight - bottomHeight;
```

### ⚡ 性能优化
- **Canvas操作**：使用drawImage的9参数模式，一次性缩放绘制
- **内存管理**：及时释放临时Canvas和Blob对象
- **边界检查**：限制分割线位置，避免无效区域

---

## 🎮 游戏开发应用

### 🎯 Unity中的应用
```csharp
// Unity的Image组件九宫格设置
Image uiImage = GetComponent<Image>();
uiImage.type = Image.Type.Sliced;
uiImage.sprite = slicedSprite;
```

### 🌟 Cocos2d中的应用  
```javascript
// Cocos2d的Scale9Sprite
let scale9Sprite = new cc.Scale9Sprite();
scale9Sprite.initWithFile("button_bg.png", cc.rect(30, 12, 40, 16));
```

### 🎨 Web开发中的应用
```css
/* CSS border-image */
.button {
  border-image: url('button_bg.png') 12 30 28 30 repeat;
  border-width: 12px 30px 28px 30px;
}
```

---

## 💡 创意用法

### 🎨 动态UI元素
- **聊天气泡**：根据文字长度自动调整
- **通知横幅**：适应不同屏幕宽度
- **卡片背景**：适应不同内容高度

### 🎮 游戏UI
- **血条背景**：适应不同最大血量
- **技能图标边框**：统一风格的图标框
- **装备槽背景**：适应不同装备类型

### 📱 移动UI
- **按钮适配**：不同语言文字长度
- **输入框**：适应不同输入内容长度
- **标签页**：适应标签数量和长度

---

## 🛠 故障排除

### ❓ 常见问题

**Q: 拉伸后图片模糊？**
A: 
- 检查拉伸区域是否选择了纯色或简单图案
- 避免在复杂纹理区域设置拉伸
- 使用更高分辨率的原图

**Q: 分割线无法拖动？**
A: 
- 确保点击在红色手柄上
- 检查是否达到最小距离限制（10px）
- 刷新页面重新上传图片

**Q: 生成的图片变形？**
A: 
- 检查分割线位置是否合理
- 确保拉伸区域内容适合重复
- 调整分割线位置，保护关键元素

**Q: 下载的文件无法使用？**
A: 
- 检查浏览器下载设置
- 确认文件完整下载
- 尝试在图片编辑软件中打开

### 🔧 调试技巧
1. **分步验证**：先设置简单的分割线，再逐步调整
2. **对比检查**：对比原图和结果图，找出问题区域
3. **极限测试**：测试极端尺寸（很宽或很高）的效果
4. **浏览器兼容**：在不同浏览器中测试功能

---

## 📚 扩展学习

### 🎯 相关技术
- **CSS Border-Image**：Web中的九宫格实现
- **Unity UI Slicing**：Unity中的九宫格切片
- **Android Nine-Patch**：Android中的可拉伸图片
- **iOS Resizable Images**：iOS中的可拉伸图片

### 📖 推荐资源
- [Unity官方九宫格教程](https://docs.unity3d.com/Manual/9SliceSprites.html)
- [CSS Border-Image详解](https://developer.mozilla.org/en-US/docs/Web/CSS/border-image)
- [游戏UI设计原理](https://gamedevelopment.tutsplus.com/tutorials/quick-tip-understand-9-slice-scaling--gamedev-3142)

---

## 🎉 开始创作！

现在您已经掌握了九宫格拉伸的精髓，开始创作属于您的可拉伸UI元素吧！

### 🏁 首次尝试建议
1. 准备一个简单的按钮图片（带圆角和边框）
2. 将分割线设置在圆角边缘，保护装饰元素
3. 设置一个较大的目标尺寸测试效果
4. 下载结果在项目中测试使用

### 🚀 进阶挑战
- 制作可拉伸的对话框背景
- 创建适应性的进度条背景
- 设计弹性的卡片背景
- 构建多样化的装饰边框

**享受九宫格拉伸创作的乐趣！** 🎨✨

---

*UI素材生成器 - 九宫格拉伸专业工具*
